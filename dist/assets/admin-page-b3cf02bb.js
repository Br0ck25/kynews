import{a2 as Nt,a3 as _t,a4 as Lt,a5 as Ut,w as te,r as l,a6 as Wt,_ as ae,a7 as Ht,a8 as Ft,e as z,f as G,a9 as Kt,aa as bt,ab as st,ac as jt,P as Ce,Q as qt,I as Ot,g as Ke,ad as Vt,h as Ge,ae as Yt,$ as Gt,a0 as Jt,a1 as Qt,R as e,B as k,T as C,a as b,af as Xt,ag as Ee,K as Zt,C as ct,S as ea}from"./index-c15c22d0.js";import{T as ee}from"./TextField-d49c81e2.js";import{C as _}from"./Chip-746b1045.js";import{F as je,I as dt,S as De}from"./Select-b61cdd98.js";import{M as ce}from"./MenuItem-e5677371.js";import{F as ut,S as mt}from"./Switch-39680d9f.js";import"./useFormControl-171a8754.js";import"./SwitchBase-258850f6.js";function ta(d){return Nt(d)||_t(d)||Lt(d)||Ut()}var aa=function(a){return{container:{height:0,overflow:"hidden",transition:a.transitions.create("height")},entered:{height:"auto",overflow:"visible"},hidden:{visibility:"hidden"},wrapper:{display:"flex"},wrapperInner:{width:"100%"}}},xt=l.forwardRef(function(a,s){var p=a.children,o=a.classes,i=a.className,m=a.collapsedHeight,y=m===void 0?"0px":m,h=a.component,$=h===void 0?"div":h,T=a.disableStrictModeCompat,R=T===void 0?!1:T,v=a.in,M=a.onEnter,g=a.onEntered,D=a.onEntering,N=a.onExit,L=a.onExited,I=a.onExiting,P=a.style,x=a.timeout,S=x===void 0?Wt.standard:x,w=a.TransitionComponent,K=w===void 0?Kt:w,B=ae(a,["children","classes","className","collapsedHeight","component","disableStrictModeCompat","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"]),Q=Ht(),oe=l.useRef(),j=l.useRef(null),J=l.useRef(),U=typeof y=="number"?"".concat(y,"px"):y;l.useEffect(function(){return function(){clearTimeout(oe.current)}},[]);var se=Q.unstable_strictMode&&!R,le=l.useRef(null),me=Ft(s,se?le:void 0),q=function(A){return function(W,F){if(A){var O=se?[le.current,W]:[W,F],X=bt(O,2),ne=X[0],re=X[1];re===void 0?A(ne):A(ne,re)}}},pe=q(function(f,A){f.style.height=U,M&&M(f,A)}),Ae=q(function(f,A){var W=j.current?j.current.clientHeight:0,F=st({style:P,timeout:S},{mode:"enter"}),O=F.duration;if(S==="auto"){var X=Q.transitions.getAutoHeightDuration(W);f.style.transitionDuration="".concat(X,"ms"),J.current=X}else f.style.transitionDuration=typeof O=="string"?O:"".concat(O,"ms");f.style.height="".concat(W,"px"),D&&D(f,A)}),ge=q(function(f,A){f.style.height="auto",g&&g(f,A)}),de=q(function(f){var A=j.current?j.current.clientHeight:0;f.style.height="".concat(A,"px"),N&&N(f)}),ye=q(L),Se=q(function(f){var A=j.current?j.current.clientHeight:0,W=st({style:P,timeout:S},{mode:"exit"}),F=W.duration;if(S==="auto"){var O=Q.transitions.getAutoHeightDuration(A);f.style.transitionDuration="".concat(O,"ms"),J.current=O}else f.style.transitionDuration=typeof F=="string"?F:"".concat(F,"ms");f.style.height=U,I&&I(f)}),ke=function(A,W){var F=se?A:W;S==="auto"&&(oe.current=setTimeout(F,J.current||0))};return l.createElement(K,z({in:v,onEnter:pe,onEntered:ge,onEntering:Ae,onExit:de,onExited:ye,onExiting:Se,addEndListener:ke,nodeRef:se?le:void 0,timeout:S==="auto"?null:S},B),function(f,A){return l.createElement($,z({className:G(o.container,i,{entered:o.entered,exited:!v&&U==="0px"&&o.hidden}[f]),style:z({minHeight:U},P),ref:me},A),l.createElement("div",{className:o.wrapper,ref:j},l.createElement("div",{className:o.wrapperInner},p)))})});xt.muiSupportAuto=!0;const la=te(aa,{name:"MuiCollapse"})(xt);var na=l.createContext({});const Ct=na;var ra=function(a){var s={duration:a.transitions.duration.shortest};return{root:{position:"relative",transition:a.transitions.create(["margin"],s),"&:before":{position:"absolute",left:0,top:-1,right:0,height:1,content:'""',opacity:1,backgroundColor:a.palette.divider,transition:a.transitions.create(["opacity","background-color"],s)},"&:first-child":{"&:before":{display:"none"}},"&$expanded":{margin:"16px 0","&:first-child":{marginTop:0},"&:last-child":{marginBottom:0},"&:before":{opacity:0}},"&$expanded + &":{"&:before":{display:"none"}},"&$disabled":{backgroundColor:a.palette.action.disabledBackground}},rounded:{borderRadius:0,"&:first-child":{borderTopLeftRadius:a.shape.borderRadius,borderTopRightRadius:a.shape.borderRadius},"&:last-child":{borderBottomLeftRadius:a.shape.borderRadius,borderBottomRightRadius:a.shape.borderRadius,"@supports (-ms-ime-align: auto)":{borderBottomLeftRadius:0,borderBottomRightRadius:0}}},expanded:{},disabled:{}}},ia=l.forwardRef(function(a,s){var p=a.children,o=a.classes,i=a.className,m=a.defaultExpanded,y=m===void 0?!1:m,h=a.disabled,$=h===void 0?!1:h,T=a.expanded,R=a.onChange,v=a.square,M=v===void 0?!1:v,g=a.TransitionComponent,D=g===void 0?la:g,N=a.TransitionProps,L=ae(a,["children","classes","className","defaultExpanded","disabled","expanded","onChange","square","TransitionComponent","TransitionProps"]),I=jt({controlled:T,default:y,name:"Accordion",state:"expanded"}),P=bt(I,2),x=P[0],S=P[1],w=l.useCallback(function(J){S(!x),R&&R(J,!x)},[x,R,S]),K=l.Children.toArray(p),B=ta(K),Q=B[0],oe=B.slice(1),j=l.useMemo(function(){return{expanded:x,disabled:$,toggle:w}},[x,$,w]);return l.createElement(Ce,z({className:G(o.root,i,x&&o.expanded,$&&o.disabled,!M&&o.rounded),ref:s,square:M},L),l.createElement(Ct.Provider,{value:j},Q),l.createElement(D,z({in:x,timeout:"auto"},N),l.createElement("div",{"aria-labelledby":Q.props.id,id:Q.props["aria-controls"],role:"region"},oe)))});const qe=te(ra,{name:"MuiAccordion"})(ia);var oa=function(a){return{root:{display:"flex",padding:a.spacing(1,2,2)}}},sa=l.forwardRef(function(a,s){var p=a.classes,o=a.className,i=ae(a,["classes","className"]);return l.createElement("div",z({className:G(p.root,o),ref:s},i))});const Oe=te(oa,{name:"MuiAccordionDetails"})(sa);var ca=function(a){var s={duration:a.transitions.duration.shortest};return{root:{display:"flex",minHeight:8*6,transition:a.transitions.create(["min-height","background-color"],s),padding:a.spacing(0,2),"&:hover:not($disabled)":{cursor:"pointer"},"&$expanded":{minHeight:64},"&$focused":{backgroundColor:a.palette.action.focus},"&$disabled":{opacity:a.palette.action.disabledOpacity}},expanded:{},focused:{},disabled:{},content:{display:"flex",flexGrow:1,transition:a.transitions.create(["margin"],s),margin:"12px 0","&$expanded":{margin:"20px 0"}},expandIcon:{transform:"rotate(0deg)",transition:a.transitions.create("transform",s),"&:hover":{backgroundColor:"transparent"},"&$expanded":{transform:"rotate(180deg)"}}}},da=l.forwardRef(function(a,s){var p=a.children,o=a.classes,i=a.className,m=a.expandIcon,y=a.IconButtonProps,h=a.onBlur,$=a.onClick,T=a.onFocusVisible,R=ae(a,["children","classes","className","expandIcon","IconButtonProps","onBlur","onClick","onFocusVisible"]),v=l.useState(!1),M=v[0],g=v[1],D=function(B){g(!0),T&&T(B)},N=function(B){g(!1),h&&h(B)},L=l.useContext(Ct),I=L.disabled,P=I===void 0?!1:I,x=L.expanded,S=L.toggle,w=function(B){S&&S(B),$&&$(B)};return l.createElement(qt,z({focusRipple:!1,disableRipple:!0,disabled:P,component:"div","aria-expanded":x,className:G(o.root,i,P&&o.disabled,x&&o.expanded,M&&o.focused),onFocusVisible:D,onBlur:N,onClick:w,ref:s},R),l.createElement("div",{className:G(o.content,x&&o.expanded)},p),m&&l.createElement(Ot,z({className:G(o.expandIcon,x&&o.expanded),edge:"end",component:"div",tabIndex:null,role:null,"aria-hidden":!0},y),m))});const Ve=te(ca,{name:"MuiAccordionSummary"})(da);var ua=l.createContext();const At=ua;var ma=function(a){return{root:{display:"table",width:"100%",borderCollapse:"collapse",borderSpacing:0,"& caption":z({},a.typography.body2,{padding:a.spacing(2),color:a.palette.text.secondary,textAlign:"left",captionSide:"bottom"})},stickyHeader:{borderCollapse:"separate"}}},pt="table",pa=l.forwardRef(function(a,s){var p=a.classes,o=a.className,i=a.component,m=i===void 0?pt:i,y=a.padding,h=y===void 0?"default":y,$=a.size,T=$===void 0?"medium":$,R=a.stickyHeader,v=R===void 0?!1:R,M=ae(a,["classes","className","component","padding","size","stickyHeader"]),g=l.useMemo(function(){return{padding:h,size:T,stickyHeader:v}},[h,T,v]);return l.createElement(At.Provider,{value:g},l.createElement(m,z({role:m===pt?null:"table",ref:s,className:G(p.root,o,v&&p.stickyHeader)},M)))});const ve=te(ma,{name:"MuiTable"})(pa);var ga=l.createContext();const _e=ga;var ya={root:{display:"table-row-group"}},fa={variant:"body"},gt="tbody",ha=l.forwardRef(function(a,s){var p=a.classes,o=a.className,i=a.component,m=i===void 0?gt:i,y=ae(a,["classes","className","component"]);return l.createElement(_e.Provider,{value:fa},l.createElement(m,z({className:G(p.root,o),ref:s,role:m===gt?null:"rowgroup"},y)))});const be=te(ya,{name:"MuiTableBody"})(ha);var Ea=function(a){return{root:z({},a.typography.body2,{display:"table-cell",verticalAlign:"inherit",borderBottom:`1px solid
    `.concat(a.palette.type==="light"?Vt(Ge(a.palette.divider,1),.88):Yt(Ge(a.palette.divider,1),.68)),textAlign:"left",padding:16}),head:{color:a.palette.text.primary,lineHeight:a.typography.pxToRem(24),fontWeight:a.typography.fontWeightMedium},body:{color:a.palette.text.primary},footer:{color:a.palette.text.secondary,lineHeight:a.typography.pxToRem(21),fontSize:a.typography.pxToRem(12)},sizeSmall:{padding:"6px 24px 6px 16px","&:last-child":{paddingRight:16},"&$paddingCheckbox":{width:24,padding:"0 12px 0 16px","&:last-child":{paddingLeft:12,paddingRight:16},"& > *":{padding:0}}},paddingCheckbox:{width:48,padding:"0 0 0 4px","&:last-child":{paddingLeft:0,paddingRight:4}},paddingNone:{padding:0,"&:last-child":{padding:0}},alignLeft:{textAlign:"left"},alignCenter:{textAlign:"center"},alignRight:{textAlign:"right",flexDirection:"row-reverse"},alignJustify:{textAlign:"justify"},stickyHeader:{position:"sticky",top:0,left:0,zIndex:2,backgroundColor:a.palette.background.default}}},va=l.forwardRef(function(a,s){var p=a.align,o=p===void 0?"inherit":p,i=a.classes,m=a.className,y=a.component,h=a.padding,$=a.scope,T=a.size,R=a.sortDirection,v=a.variant,M=ae(a,["align","classes","className","component","padding","scope","size","sortDirection","variant"]),g=l.useContext(At),D=l.useContext(_e),N=D&&D.variant==="head",L,I;y?(I=y,L=N?"columnheader":"cell"):I=N?"th":"td";var P=$;!P&&N&&(P="col");var x=h||(g&&g.padding?g.padding:"default"),S=T||(g&&g.size?g.size:"medium"),w=v||D&&D.variant,K=null;return R&&(K=R==="asc"?"ascending":"descending"),l.createElement(I,z({ref:s,className:G(i.root,i[w],m,o!=="inherit"&&i["align".concat(Ke(o))],x!=="default"&&i["padding".concat(Ke(x))],S!=="medium"&&i["size".concat(Ke(S))],w==="head"&&g&&g.stickyHeader&&i.stickyHeader),"aria-sort":K,role:L,scope:P},M))});const r=te(Ea,{name:"MuiTableCell"})(va);var ba={root:{display:"table-header-group"}},xa={variant:"head"},yt="thead",Ca=l.forwardRef(function(a,s){var p=a.classes,o=a.className,i=a.component,m=i===void 0?yt:i,y=ae(a,["classes","className","component"]);return l.createElement(_e.Provider,{value:xa},l.createElement(m,z({className:G(p.root,o),ref:s,role:m===yt?null:"rowgroup"},y)))});const xe=te(ba,{name:"MuiTableHead"})(Ca);var Aa=function(a){return{root:{color:"inherit",display:"table-row",verticalAlign:"middle",outline:0,"&$hover:hover":{backgroundColor:a.palette.action.hover},"&$selected, &$selected:hover":{backgroundColor:Ge(a.palette.secondary.main,a.palette.action.selectedOpacity)}},selected:{},hover:{},head:{},footer:{}}},ft="tr",Sa=l.forwardRef(function(a,s){var p=a.classes,o=a.className,i=a.component,m=i===void 0?ft:i,y=a.hover,h=y===void 0?!1:y,$=a.selected,T=$===void 0?!1:$,R=ae(a,["classes","className","component","hover","selected"]),v=l.useContext(_e);return l.createElement(m,z({ref:s,className:G(p.root,o,v&&{head:p.head,footer:p.footer}[v.variant],h&&p.hover,T&&p.selected),role:m===ft?null:"row"},R))});const Y=te(Aa,{name:"MuiTableRow"})(Sa);var Je={},ka=Jt,$a=Qt;Object.defineProperty(Je,"__esModule",{value:!0});var Ne=Je.default=void 0,Ra=$a(l),Ta=ka(Gt()),Pa=(0,Ta.default)(Ra.createElement("path",{d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore");Ne=Je.default=Pa;const E=new ea({}.REACT_APP_API_BASE_URL),ht=["today","national","sports","weather","schools","obituaries"];function Ye(d){var a;return!!((a=d==null?void 0:d.publishedAt)!=null&&a.startsWith("9999"))}function La(){const[d,a]=l.useState(""),[s,p]=l.useState(!!E.getAdminPanelKey()),[o,i]=l.useState(""),[m,y]=l.useState(!0),[h,$]=l.useState(0),[T,R]=l.useState([]),[v,M]=l.useState(null),[g,D]=l.useState(null),[N,L]=l.useState([]),[I,P]=l.useState([]),[x,S]=l.useState(""),[w,K]=l.useState("all"),[B,Q]=l.useState(""),[oe,j]=l.useState(!1),[J,U]=l.useState([]),[se,le]=l.useState(null),[me,q]=l.useState(!1),[pe,Ae]=l.useState(!1),[ge,de]=l.useState(null),[ye,Se]=l.useState(null),[ke,f]=l.useState(null),[A,W]=l.useState([]),[F,O]=l.useState(null),[X,ne]=l.useState({}),[re,Le]=l.useState(""),[$e,Re]=l.useState(""),[Qe,Te]=l.useState(""),[Xe,Pe]=l.useState(""),[Ze,Ue]=l.useState(""),[fe,We]=l.useState(!1),[Be,Ie]=l.useState(""),[He,et]=l.useState(!1),[tt,at]=l.useState(!1),[lt,we]=l.useState(null),[nt,Z]=l.useState(""),ue=async()=>{if(s){y(!0),i("");try{const[t,n,u]=await Promise.all([E.getAdminSources(),E.getAdminArticles({category:w,search:B,limit:200}),E.getBlockedArticles()]),[c,H]=await Promise.all([E.getAdminMetrics(),E.getAdminRejections()]);R(t.items||[]),M(t),D((c==null?void 0:c.latest)||null),L((H==null?void 0:H.items)||[]),P((H==null?void 0:H.duplicateItems)||[]);const ie=n.items||[];U(ie),le(n.nextCursor||null),q(!!n.nextCursor),W((u==null?void 0:u.items)||[]),ne({})}catch(t){console.error(t),i((t==null?void 0:t.errorMessage)||"Unable to load admin data. Check password and worker deployment.")}finally{y(!1)}}};l.useEffect(()=>{s&&ue()},[s]);const rt=async()=>{if(s){y(!0),i("");try{const t=await E.getAdminArticles({category:w,search:B,limit:200}),n=t.items||[];U(n),le(t.nextCursor||null),q(!!t.nextCursor),ne({})}catch(t){console.error(t),i((t==null?void 0:t.errorMessage)||"Unable to filter articles.")}finally{y(!1)}}},ze=(t,n)=>{ne(u=>({...u,[t]:{...u[t]||{},...n}}))},St=async t=>{const n=X[t.id]||{};de(t.id);try{await E.retagArticle({id:t.id,category:n.category??t.category,isKentucky:n.isKentucky??t.isKentucky,county:n.county??t.county}),U(u=>u.map(c=>c.id===t.id?{...c,category:n.category??t.category,isKentucky:n.isKentucky??t.isKentucky,county:n.county??t.county,publishedAt:n.publishedAt??t.publishedAt}:c)),ne(u=>({...u,[t.id]:{}}))}catch(u){console.error(u),i((u==null?void 0:u.errorMessage)||"Retag failed.")}finally{de(null)}},kt=async t=>{const u=(X[t.id]||{}).publishedAt??t.publishedAt;if(!u){i("Published date/time is required.");return}de(t.id),i("");try{const c=await E.updateAdminArticleDateTime({id:t.id,publishedAt:u}),H=(c==null?void 0:c.publishedAt)||u;U(ie=>ie.map(he=>he.id===t.id?{...he,publishedAt:H}:he)),ne(ie=>({...ie,[t.id]:{...ie[t.id]||{},publishedAt:H}}))}catch(c){console.error(c),i((c==null?void 0:c.errorMessage)||"Unable to update date/time.")}finally{de(null)}},it=async(t,n)=>{if(window.confirm(n?`Delete article #${t.id} and block it from future ingestion?`:`Delete article #${t.id}?`)){Se(t.id),i("");try{if(await E.deleteAdminArticle({id:t.id,block:n,reason:n?"Blocked by admin console":""}),U(c=>c.filter(H=>H.id!==t.id)),n){const c=await E.getBlockedArticles();W((c==null?void 0:c.items)||[])}}catch(c){console.error(c),i((c==null?void 0:c.errorMessage)||"Unable to delete article.")}finally{Se(null)}}},$t=async t=>{if(t!=null&&t.id){O(t.id),i("");try{await E.unblockArticle({id:t.id}),W(n=>n.filter(u=>u.id!==t.id))}catch(n){console.error(n),i((n==null?void 0:n.errorMessage)||"Unable to unblock article.")}finally{O(null)}}},ot=async()=>{i(""),E.setAdminPanelKey(d);try{await E.getAdminSources(),p(!0),a("")}catch(t){p(!1),E.setAdminPanelKey(""),i((t==null?void 0:t.errorMessage)||"Invalid admin password.")}},Rt=()=>{E.setAdminPanelKey(""),p(!1),R([]),U([]),le(null),q(!1),M(null),D(null),L([]),P([])},Tt=async t=>{if(t!=null&&t.url){S(t.url),i("");try{await E.publishAdminRejection({url:t.url,sourceUrl:t.sourceUrl,providedTitle:t.title,feedPublishedAt:t.publishedAt}),await ue()}catch(n){i((n==null?void 0:n.errorMessage)||"Unable to publish rejected item.")}finally{S("")}}},Pt=async()=>{if(!(!me||!se||pe)){Ae(!0);try{const t=await E.getAdminArticles({category:w,search:B,limit:200,cursor:se}),n=t.items||[];U(u=>[...u,...n]),le(t.nextCursor||null),q(!!t.nextCursor)}catch(t){i((t==null?void 0:t.errorMessage)||"Unable to load more articles.")}finally{Ae(!1)}}},Fe=t=>`https://localkynews.com/post?articleId=${t}`,Bt=async t=>{f(t.id),i("");try{const n=new Date().toISOString();await E.updateAdminArticleDateTime({id:t.id,publishedAt:n}),U(u=>u.map(c=>c.id===t.id?{...c,publishedAt:n}:c))}catch(n){console.error(n),i((n==null?void 0:n.errorMessage)||"Unable to publish article.")}finally{f(null)}},It=async()=>{if(re.trim()){at(!0),Z(""),we(null);try{const t=await E.previewFacebookPost(re.trim());t!=null&&t.ok?(t.title&&Re(t.title),t.body&&Te(t.body),t.imageUrl&&Pe(t.imageUrl),t.publishedAt&&!Be&&Ie(Et(t.publishedAt))):Z((t==null?void 0:t.message)||"Could not auto-fill from Facebook. Fill fields manually.")}catch(t){Z((t==null?void 0:t.errorMessage)||"Failed to load Facebook post.")}finally{at(!1)}}},wt=async()=>{if(!$e.trim()){Z("Title is required.");return}et(!0),Z(""),we(null);try{const t=Be?vt(Be):new Date().toISOString(),n=await E.createManualArticle({title:$e.trim(),body:Qe.trim()||null,imageUrl:Xe.trim()||null,sourceUrl:re.trim()||null,county:Ze||null,isDraft:fe,publishedAt:t});(n==null?void 0:n.status)==="inserted"?(we(`${fe?"Draft saved":"Article published"}! ID: ${n.id} | Category: ${n.category} | County: ${n.county||"none"}`),Le(""),Re(""),Te(""),Pe(""),Ue(""),We(!1),Ie(""),rt()):(n==null?void 0:n.status)==="duplicate"?Z(`Duplicate – an article with this URL already exists (ID: ${n.id}).`):Z("Unexpected response from server.")}catch(t){Z((t==null?void 0:t.errorMessage)||"Failed to create article.")}finally{et(!1)}},zt=async()=>{i("");try{await E.adminIngest({includeSchools:!0,limitPerSource:0}),await ue()}catch(t){i((t==null?void 0:t.errorMessage)||"Unable to start ingest.")}},Mt=async()=>{if(window.confirm("This will DELETE all article rows and start re-ingest. Continue?")){i("");try{await E.adminPurgeAndReingest({includeSchools:!0,limitPerSource:0}),await ue()}catch(n){i((n==null?void 0:n.errorMessage)||"Purge/re-ingest failed.")}}},Me=J.filter(Ye).length,Dt=oe?J.filter(Ye):J;return s?e.createElement(k,null,e.createElement(k,{style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",marginBottom:8}},e.createElement(C,{variant:"h5"},"Admin Console"),e.createElement(b,{size:"small",variant:"outlined",onClick:Rt},"Lock")),o&&e.createElement(C,{color:"error",variant:"body2",style:{marginBottom:10}},o),e.createElement(Ce,{square:!0,style:{marginBottom:16}},e.createElement(Xt,{value:h,onChange:(t,n)=>$(n),indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto"},e.createElement(Ee,{label:"Dashboard"}),e.createElement(Ee,{label:"Create Article"}),e.createElement(Ee,{label:Me>0?`Articles (${Me} draft${Me!==1?"s":""})`:"Articles"}),e.createElement(Ee,{label:"Sources"}),e.createElement(Ee,{label:"Blocked"}))),h===0&&e.createElement(k,null,e.createElement(k,{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:16}},e.createElement(b,{variant:"contained",color:"primary",onClick:zt},"Ingest new articles"),e.createElement(b,{variant:"contained",color:"secondary",onClick:Mt},"Purge + Re-ingest"),e.createElement(b,{variant:"outlined",onClick:ue,disabled:m},m?"Loading…":"Refresh")),g&&e.createElement(Ce,{style:{padding:12,marginBottom:16}},e.createElement(C,{variant:"subtitle2",gutterBottom:!0},"Latest Ingest Run"),e.createElement(k,{style:{display:"flex",gap:8,flexWrap:"wrap"}},e.createElement(_,{size:"small",label:`Trigger: ${g.trigger??"—"}`}),e.createElement(_,{size:"small",label:`Rate/min: ${g.ingestRatePerMinute??0}`,color:"primary"}),e.createElement(_,{size:"small",label:`Inserted: ${g.inserted??0}`}),e.createElement(_,{size:"small",label:`Duplicates: ${g.duplicate??0}`}),e.createElement(_,{size:"small",label:`Rejected: ${g.rejected??0}`}),e.createElement(_,{size:"small",label:`Low-word: ${g.lowWordDiscards??0}`}),e.createElement(_,{size:"small",label:`Duration: ${((g.durationMs??0)/1e3).toFixed(1)}s`}))),e.createElement(Ce,{style:{padding:16}},e.createElement(C,{variant:"h6",gutterBottom:!0},"Ingest Decisions (Latest Run)"),e.createElement(C,{variant:"body2",color:"textSecondary",gutterBottom:!0},"Rejected items can be force-published. Duplicates indicate URLs already stored."),e.createElement(qe,{defaultExpanded:!1},e.createElement(Ve,{expandIcon:e.createElement(Ne,null)},e.createElement(C,{variant:"subtitle2"},"Rejected (",N.length,")")),e.createElement(Oe,{style:{display:"block",padding:0}},N.length===0?e.createElement(C,{variant:"body2",color:"textSecondary",style:{padding:12}},"No rejected samples captured in the latest run."):e.createElement(ve,{size:"small",style:{marginBottom:12}},e.createElement(xe,null,e.createElement(Y,null,e.createElement(r,null,"URL"),e.createElement(r,null,"Reason"),e.createElement(r,null,"Source"),e.createElement(r,null,"Local"),e.createElement(r,null,"Publish"))),e.createElement(be,null,N.slice(0,100).map((t,n)=>e.createElement(Y,{key:`${t.url}-${n}`},e.createElement(r,{style:{maxWidth:300,overflowWrap:"anywhere"}},t.url),e.createElement(r,null,t.reason||"unknown"),e.createElement(r,{style:{maxWidth:220,overflowWrap:"anywhere"}},t.sourceUrl||"—"),e.createElement(r,null,t.id?e.createElement(b,{size:"small",variant:"outlined",color:"primary",href:Fe(t.id),target:"_blank",rel:"noopener noreferrer"},"Open"):"—"),e.createElement(r,null,e.createElement(b,{size:"small",variant:"contained",color:"primary",disabled:x===t.url,onClick:()=>Tt(t)},x===t.url?"Publishing…":"Publish")))))))),e.createElement(qe,{defaultExpanded:!1},e.createElement(Ve,{expandIcon:e.createElement(Ne,null)},e.createElement(C,{variant:"subtitle2"},"Duplicates (",I.length,")")),e.createElement(Oe,{style:{display:"block",padding:0}},I.length===0?e.createElement(C,{variant:"body2",color:"textSecondary",style:{padding:12}},"No duplicate samples captured in the latest run."):e.createElement(ve,{size:"small"},e.createElement(xe,null,e.createElement(Y,null,e.createElement(r,null,"URL"),e.createElement(r,null,"Reason"),e.createElement(r,null,"Source"),e.createElement(r,null,"Local"))),e.createElement(be,null,I.slice(0,100).map((t,n)=>e.createElement(Y,{key:`${t.url}-dup-${n}`},e.createElement(r,{style:{maxWidth:300,overflowWrap:"anywhere"}},t.url),e.createElement(r,null,t.reason||"duplicate"),e.createElement(r,{style:{maxWidth:220,overflowWrap:"anywhere"}},t.sourceUrl||"—"),e.createElement(r,null,t.id?e.createElement(b,{size:"small",variant:"outlined",color:"primary",href:Fe(t.id),target:"_blank",rel:"noopener noreferrer"},"Open"):"—"))))))))),h===1&&e.createElement(k,null,e.createElement(qe,{defaultExpanded:!0},e.createElement(Ve,{expandIcon:e.createElement(Ne,null)},e.createElement(C,{variant:"h6"},"Create Manual Article")),e.createElement(Oe,{style:{display:"block"}},e.createElement(C,{variant:"body2",color:"textSecondary",style:{marginBottom:12}},"Paste a Facebook post URL to auto-fill — no access token needed, public pages are scraped automatically. Or fill fields manually. All articles are tagged as Kentucky content; category is auto-classified by AI. Drafts are saved privately and can be published later from the Articles tab."),e.createElement(k,{style:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"}},e.createElement(ee,{variant:"outlined",size:"small",label:"Facebook Post URL (optional)",placeholder:"https://www.facebook.com/leslieCoBOE/posts/…",value:re,onChange:t=>Le(t.target.value),style:{minWidth:360,flex:1}}),e.createElement(b,{variant:"outlined",color:"primary",disabled:tt||!re.trim(),onClick:It},tt?"Loading…":"Load from Facebook")),e.createElement(ee,{fullWidth:!0,variant:"outlined",size:"small",label:"Title *",value:$e,onChange:t=>Re(t.target.value),style:{marginBottom:12}}),e.createElement(ee,{fullWidth:!0,variant:"outlined",size:"small",label:"Body (optional)",multiline:!0,rows:8,value:Qe,onChange:t=>Te(t.target.value),style:{marginBottom:12}}),e.createElement(ee,{fullWidth:!0,variant:"outlined",size:"small",label:"Image URL (optional)",value:Xe,onChange:t=>Pe(t.target.value),style:{marginBottom:12}}),e.createElement(ee,{variant:"outlined",size:"small",label:"Date & Time (optional — defaults to now)",type:"datetime-local",value:Be,onChange:t=>Ie(t.target.value),InputLabelProps:{shrink:!0},style:{marginBottom:12,minWidth:280}}),e.createElement(k,{style:{display:"flex",gap:12,alignItems:"center",flexWrap:"wrap",marginBottom:16}},e.createElement(je,{variant:"outlined",size:"small",style:{minWidth:200}},e.createElement(dt,null,"County (optional)"),e.createElement(De,{value:Ze,onChange:t=>Ue(t.target.value),label:"County (optional)"},e.createElement(ce,{value:""},e.createElement("em",null,"None / let AI decide")),Zt.map(t=>e.createElement(ce,{key:t,value:t},t)))),e.createElement(ut,{control:e.createElement(mt,{checked:fe,onChange:t=>We(t.target.checked),color:"primary"}),label:fe?"Save as draft (private)":"Publish immediately"})),e.createElement(k,{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"}},e.createElement(b,{variant:"contained",color:"primary",disabled:He||!$e.trim(),onClick:wt},He?"Saving…":fe?"Save Draft":"Publish Article"),e.createElement(b,{variant:"outlined",disabled:He,onClick:()=>{Le(""),Re(""),Te(""),Pe(""),Ue(""),We(!1),Ie(""),Z(""),we(null)}},"Clear")),nt&&e.createElement(C,{color:"error",variant:"body2",style:{marginTop:10}},nt),lt&&e.createElement(C,{style:{color:"green",marginTop:10},variant:"body2"},lt)))),h===2&&e.createElement(k,null,e.createElement(C,{variant:"h6",gutterBottom:!0},"Articles"),e.createElement(k,{style:{display:"flex",gap:12,flexWrap:"wrap",marginBottom:12,alignItems:"center"}},e.createElement(je,{variant:"outlined",size:"small",style:{minWidth:180}},e.createElement(dt,null,"Category"),e.createElement(De,{value:w,onChange:t=>K(t.target.value),label:"Category"},e.createElement(ce,{value:"all"},"all"),ht.map(t=>e.createElement(ce,{key:t,value:t},t)))),e.createElement(ee,{variant:"outlined",size:"small",label:"Search",value:B,onChange:t=>Q(t.target.value)}),e.createElement(b,{variant:"contained",color:"primary",onClick:rt},"Filter"),e.createElement(b,{variant:"outlined",onClick:ue,disabled:m},"Reload All"),e.createElement(ut,{control:e.createElement(mt,{checked:oe,onChange:t=>j(t.target.checked),color:"primary",size:"small"}),label:`Drafts only (${Me})`}),e.createElement(_,{label:`Loaded: ${J.length}`,size:"small"})),m?e.createElement(ct,{size:24}):e.createElement(ve,{size:"small"},e.createElement(xe,null,e.createElement(Y,null,e.createElement(r,null,"ID"),e.createElement(r,null,"Status"),e.createElement(r,null,"Title"),e.createElement(r,null,"Published (UTC)"),e.createElement(r,null,"Category"),e.createElement(r,null,"KY"),e.createElement(r,null,"County"),e.createElement(r,null,"Links"),e.createElement(r,null,"Actions"))),e.createElement(be,null,Dt.map(t=>{const n=Ye(t),u=X[t.id]||{},c=u.category??t.category,H=u.isKentucky??t.isKentucky,ie=u.county??t.county??"",he=u.publishedAt??t.publishedAt??"";return e.createElement(Y,{key:t.id,style:n?{backgroundColor:"#fffde7"}:{}},e.createElement(r,null,t.id),e.createElement(r,null,n?e.createElement(_,{size:"small",label:"DRAFT",style:{backgroundColor:"#ff9800",color:"#fff"}}):e.createElement(_,{size:"small",label:"Live",color:"primary"})),e.createElement(r,{style:{maxWidth:360,overflowWrap:"anywhere"}},t.title),e.createElement(r,null,n?e.createElement(C,{variant:"caption",color:"textSecondary"},"Not published"):e.createElement(ee,{variant:"outlined",size:"small",type:"datetime-local",value:Et(he),onChange:V=>ze(t.id,{publishedAt:vt(V.target.value)}),InputLabelProps:{shrink:!0}})),e.createElement(r,null,e.createElement(je,{variant:"outlined",size:"small",style:{minWidth:130}},e.createElement(De,{value:c,onChange:V=>ze(t.id,{category:V.target.value})},ht.map(V=>e.createElement(ce,{key:V,value:V},V))))),e.createElement(r,null,e.createElement(De,{value:H?"yes":"no",variant:"outlined",size:"small",onChange:V=>ze(t.id,{isKentucky:V.target.value==="yes"})},e.createElement(ce,{value:"yes"},"yes"),e.createElement(ce,{value:"no"},"no"))),e.createElement(r,null,e.createElement(ee,{variant:"outlined",size:"small",value:ie,onChange:V=>ze(t.id,{county:V.target.value}),placeholder:"optional",style:{width:120}})),e.createElement(r,null,e.createElement(k,{style:{display:"flex",gap:6,flexWrap:"wrap"}},!n&&e.createElement(b,{size:"small",variant:"outlined",color:"primary",href:Fe(t.id),target:"_blank",rel:"noopener noreferrer"},"Live"),e.createElement(b,{size:"small",variant:"outlined",href:t.canonicalUrl||t.sourceUrl||"#",target:"_blank",rel:"noopener noreferrer",disabled:!t.canonicalUrl&&!t.sourceUrl},"Source"))),e.createElement(r,null,e.createElement(k,{style:{display:"flex",gap:6,flexWrap:"wrap"}},n&&e.createElement(b,{size:"small",variant:"contained",color:"primary",disabled:ke===t.id,onClick:()=>Bt(t)},ke===t.id?"Publishing…":"Publish Now"),e.createElement(b,{size:"small",variant:"contained",color:"primary",disabled:ge===t.id,onClick:()=>St(t)},ge===t.id?"Saving…":"Save tags"),!n&&e.createElement(b,{size:"small",variant:"outlined",color:"primary",disabled:ge===t.id,onClick:()=>kt(t)},"Save date"),e.createElement(b,{size:"small",variant:"outlined",color:"secondary",disabled:ye===t.id,onClick:()=>it(t,!1)},"Delete"),e.createElement(b,{size:"small",variant:"contained",color:"secondary",disabled:ye===t.id,onClick:()=>it(t,!0)},ye===t.id?"Working…":"Delete + Block"))))}))),e.createElement(k,{style:{marginTop:10,display:"flex",justifyContent:"flex-end"}},e.createElement(b,{variant:"contained",color:"primary",disabled:!me||pe,onClick:Pt},pe?"Loading…":me?"Load More":"No More Articles"))),h===3&&e.createElement(k,null,e.createElement(C,{variant:"h6",gutterBottom:!0},"Source Health"),v&&e.createElement(k,{style:{display:"flex",gap:8,marginBottom:12,flexWrap:"wrap"}},e.createElement(_,{label:`Configured: ${v.totalConfiguredSources||0}`}),e.createElement(_,{label:`Active: ${v.activeSources||0}`,color:"primary"}),e.createElement(_,{label:`No articles yet: ${v.inactiveSources||0}`})),m?e.createElement(ct,{size:24}):e.createElement(ve,{size:"small"},e.createElement(xe,null,e.createElement(Y,null,e.createElement(r,null,"Source"),e.createElement(r,{align:"right"},"Articles"),e.createElement(r,null,"Latest Published"),e.createElement(r,null,"Status"))),e.createElement(be,null,T.slice(0,200).map(t=>e.createElement(Y,{key:t.sourceUrl},e.createElement(r,{style:{maxWidth:420,overflowWrap:"anywhere"}},t.sourceUrl),e.createElement(r,{align:"right"},t.articleCount),e.createElement(r,null,t.latestPublishedAt||"—"),e.createElement(r,null,e.createElement(_,{size:"small",label:t.status,color:t.status==="active"?"primary":"default"}))))))),h===4&&e.createElement(k,null,e.createElement(C,{variant:"h6",gutterBottom:!0},"Blocked Articles"),e.createElement(C,{variant:"body2",color:"textSecondary",gutterBottom:!0},"Blocked URLs are rejected during future ingest runs."),e.createElement(ve,{size:"small"},e.createElement(xe,null,e.createElement(Y,null,e.createElement(r,null,"ID"),e.createElement(r,null,"URL"),e.createElement(r,null,"Reason"),e.createElement(r,null,"Blocked At"),e.createElement(r,null,"Action"))),e.createElement(be,null,A.length===0?e.createElement(Y,null,e.createElement(r,{colSpan:5},"No blocked articles.")):A.map(t=>e.createElement(Y,{key:`blocked-${t.id}`},e.createElement(r,null,t.id),e.createElement(r,{style:{maxWidth:420,overflowWrap:"anywhere"}},t.canonicalUrl||t.sourceUrl||"—"),e.createElement(r,null,t.reason||"—"),e.createElement(r,null,t.createdAt||"—"),e.createElement(r,null,e.createElement(b,{size:"small",variant:"outlined",color:"primary",disabled:F===t.id,onClick:()=>$t(t)},F===t.id?"Unblocking…":"Unblock")))))))):e.createElement(k,null,e.createElement(C,{variant:"h5",gutterBottom:!0},"Admin Console"),e.createElement(C,{variant:"body2",color:"textSecondary",gutterBottom:!0},"Enter admin password to continue."),e.createElement(Ce,{style:{padding:16,maxWidth:420}},e.createElement(ee,{fullWidth:!0,variant:"outlined",size:"small",label:"Admin Password",type:"password",value:d,onChange:t=>a(t.target.value),onKeyDown:t=>t.key==="Enter"&&ot()}),e.createElement(k,{style:{marginTop:12,display:"flex",gap:8}},e.createElement(b,{variant:"contained",color:"primary",onClick:ot},"Unlock")),o&&e.createElement(C,{color:"error",variant:"body2",style:{marginTop:10}},o)))}function Et(d){if(!d)return"";const a=new Date(d);if(!Number.isFinite(a.getTime()))return"";const s=h=>String(h).padStart(2,"0"),p=a.getFullYear(),o=s(a.getMonth()+1),i=s(a.getDate()),m=s(a.getHours()),y=s(a.getMinutes());return`${p}-${o}-${i}T${m}:${y}`}function vt(d){if(!d)return"";const a=new Date(d);return Number.isFinite(a.getTime())?a.toISOString():""}export{La as default};
