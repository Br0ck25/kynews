import{x as B,p as F,k as K,y as _,r,R as e,n as R,a as k,T as c,I as C,z as $,A as I,D as M,E as Y,m as U,S as q}from"./index-024f792c.js";import{F as D}from"./featured-post-component-693a9d20.js";import{P as b}from"./posts-component-821a394d.js";import{S as H}from"./skeletons-component-8cf6a8aa.js";import"./Chip-34dbfc05.js";const j=U(o=>({root:{},headerActions:{display:"inline-flex",verticalAlign:"middle",marginLeft:o.spacing(1)},backLink:{marginBottom:o.spacing(2)},divider:{margin:o.spacing(2,0)}})),i=new q({}.REACT_APP_API_BASE_URL);function W(){const o=j(),{countySlug:P}=B(),w=F(),d=K(),t=_(P),[l,N]=r.useState([]),[y,A]=r.useState([]),[L,f]=r.useState(!0),[p,g]=r.useState(""),[T,E]=r.useState(!1),[h,v]=r.useState("");r.useEffect(()=>{if(!t)return;document.title=`${t} County, KY News — Local KY News`;const a=`The latest news from ${t} County, Kentucky.`;let s=document.querySelector('meta[name="description"]');s||(s=document.createElement("meta"),s.name="description",document.head.appendChild(s)),s.setAttribute("content",a)},[t]);const u=e.useCallback(a=>{const s=(a||[]).filter(n=>n.active).map(n=>n.value);d(R(s))},[d]);r.useEffect(()=>{t&&i.getTags().then(a=>{const s=a.find(n=>n.value===t&&n.active);E(!!s),u(a)})},[t,u]),r.useEffect(()=>{t&&(f(!0),g(""),i.getPosts({category:"today",counties:[t],limit:50}).then(a=>{if(N(a),a.length<5)return i.getPosts({category:"today",limit:10}).then(s=>{const n=s.filter(m=>m.county!==t).slice(0,5-a.length);A(n)})}).catch(a=>{g(a.errorMessage||"Failed to load posts.")}).finally(()=>f(!1)))},[t]);const x=async()=>{const a=`${t} County, KY News`,s=window.location.href,n=`Latest from ${t} County on Kentucky News`;try{navigator.share?await navigator.share({title:a,text:n,url:s}):(await navigator.clipboard.writeText(s),v("Link copied to clipboard"))}catch(m){console.error(m)}},z=()=>{t&&i.saveTags(t).then(a=>{const s=a.find(n=>n.value===t&&n.active);E(!!s),u(a),v(s?"County saved":"County removed")})},S=()=>{w.push("/local")};return t?e.createElement("div",{className:o.root},e.createElement(k,{size:"small",onClick:S,className:o.backLink},"← All Counties"),e.createElement(c,{variant:"h5",gutterBottom:!0},t," County",e.createElement("span",{className:o.headerActions},e.createElement(C,{color:"primary",size:"small","aria-label":"Share county",onClick:x},e.createElement($,{fontSize:"small"})),e.createElement(C,{color:T?"secondary":"primary",size:"small","aria-label":"Save county",onClick:z},e.createElement(I,{fontSize:"small"})))),L?e.createElement(H,{showFeaturedSkeleton:!0}):e.createElement(e.Fragment,null,p&&e.createElement(c,{color:"error",variant:"body2"},p),l&&l.length>0?e.createElement(e.Fragment,null,e.createElement(D,{post:l[0]}),e.createElement(b,{posts:l.slice(1)})):e.createElement(c,{variant:"body1"},"No articles found for ",t," County."),l.length<5&&y.length>0&&e.createElement(e.Fragment,null,e.createElement(M,{className:o.divider}),e.createElement(c,{variant:"subtitle1",gutterBottom:!0},"More from Kentucky"),e.createElement(b,{posts:y}))),h&&e.createElement(Y,{message:h})):e.createElement("div",null,e.createElement(k,{size:"small",onClick:S,className:o.backLink},"← All Counties"),e.createElement(c,{variant:"h5"},"County not found"),e.createElement(c,{variant:"body2"},"The URL you provided does not match a valid Kentucky county."))}export{W as default};
